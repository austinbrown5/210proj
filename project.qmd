---
title: "210 Project"
author: "Austin Brown and Ryan Yu"
format: pdf
---
```{r}
library(tidymodels)
library(tidyverse)
library(Stat2Data)
library(MASS)
library(caret)
library(leaps)
library(glmnet)
library(broom)
library(nnet)
library(ggfortify)
library(naniar)
library(UpSetR)
library(lme4)
library(ggplot2)
```

```{r}
player_data <- read.csv(
  "https://query.data.world/s/5zns27g5v3ce74zgwtcosxygtexpef?dws=00000", 
  header=TRUE, stringsAsFactors=FALSE)
player_data <-subset(player_data, select = -c(url,birth_date, X, NCAA_efgpct
            ) )
player_data$career_length <- player_data$active_to - player_data$active_from
player_data <- na.omit(player_data)
```


Potential Cleaning for College Column
```{r}
#player_data$college <- gsub("\\bUniversity \\b", "", player_data$college)
# Load library
#library(stringr)

# If there are two schools listed, only keep the first one
#player_data$college <- str_extract(player_data$college, "^[^,]*")
#player_data$college <- gsub("\\s*University\\s*", "", player_data$college)
#player_data$college <- gsub("(?i)\\s*of\\s*", "", player_data$college)
#unique(player_data$college)
```

Position Variable
```{r}
#test
player_data$position<- substring(player_data$position, first=1, last=1)

```

EDA
```{r Graph1}
player_data %>%
  filter(NBA_g_played > 20) %>% filter(NCAA_games > 20) %>%
ggplot(mapping = aes(x = NCAA_ppg, y = NBA_ppg)) +
  geom_point() +
  geom_smooth(method = "lm") + 
  labs(title = "College vs. NBA PPG", 
       x = "NCAA PPG", y = "NBA PPG")
```
```{r Graph2}
player_data %>%
  filter(NBA_g_played > 20) %>% filter(NCAA_games > 20) %>%
ggplot(mapping = aes(x = NCAA_fgpct, y = NBA_ppg)) +
  geom_point() +
  geom_smooth(method = "lm") + 
  labs(title = "College FG pct vs. NBA PPG", 
       x = "NCAA FG pct", y = "NBA PPG")
```
```{r Categ. Var}
range(player_data$NCAA_games)
breakpoints <- quantile(player_data$NCAA_games, probs = c(0, 0.25, 0.5, 0.75, 1))

# Use the cut() function to create the four categories
player_data$NCAA_length <- cut(player_data$NCAA_games, breaks = breakpoints, 
                               labels = c("low", "mid-low", "mid-high", "high"))

```

```{r Graph3}
player_data %>% 
  ggplot(aes(x = NCAA_ppg, y = NBA_ppg, color = NCAA_length)) +
  geom_point() +
  facet_wrap(~NCAA_length, nrow = 2, ncol = 4) +
  labs(x = "NCAA PPG", y = "NBA PPG", color = "NCAA Career Length", title = 
         "NCAA PPG vs. NBA PPG, by Length of Time in College")
```
```{r graph4}
ggplot(data = player_data, mapping = aes(y = NBA_ppg, x = NCAA_length)) +
  geom_boxplot() +
  labs(x = "NCAA Career Length", y = "NBA PPG", title = 
         "NBA PPG, by Length of Time in College")
```








Austin Model
```{r}
```
