---
title: "210 Project"
author: "Austin Brown and Ryan Yu"
format: pdf
---
```{r}
library(tidymodels)
library(tidyverse)
library(Stat2Data)
library(MASS)
library(caret)
library(leaps)
library(glmnet)
library(broom)
library(nnet)
library(ggfortify)
library(naniar)
library(UpSetR)
library(lme4)
library(ggplot2)
```

```{r}
player_data <- read.csv(
  "https://query.data.world/s/5zns27g5v3ce74zgwtcosxygtexpef?dws=00000", 
  header=TRUE, stringsAsFactors=FALSE)
player_data <-subset(player_data, select = -c(url,birth_date, X) )
player_data$career_length <- player_data$active_to - player_data$active_from
```


Potential Cleaning for College Column
```{r}
#player_data$college <- gsub("\\bUniversity \\b", "", player_data$college)
# Load library
#library(stringr)

# If there are two schools listed, only keep the first one
#player_data$college <- str_extract(player_data$college, "^[^,]*")
#player_data$college <- gsub("\\s*University\\s*", "", player_data$college)
#player_data$college <- gsub("(?i)\\s*of\\s*", "", player_data$college)
#unique(player_data$college)
```

Position Variable
```{r}
#test
player_data$position <- sapply(strsplit(as.character(player_data$position), "-"), 
                                function(x) if(length(x) >= 2) substring(x[[1]], 1, 1) ifelse(length(x) < 2) subtring(x[[1]])
```

EDA
```{r}
# filter for min attempts, also change axis lengtha
ggplot(data = player_data, mapping = aes(x = NCAA__3ptpct, y = NBA__3ptpct)) +
  geom_point() +
  geom_smooth(method = "lm") + 
  labs(title = "College vs. NBA 3pt. Percentage", 
       x = "NCAA 3pt. %", y = "NBA 3pt. %")
```

Ryan Model
```{r}
```

Austin Model
```{r}
```
